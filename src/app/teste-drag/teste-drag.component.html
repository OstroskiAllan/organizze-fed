<div class="dashzao">
  <div class="container">
    <h2>Analyzing</h2>
    <div cdkDropList #analyzingList="cdkDropList" [cdkDropListData]="analyzing"
         [cdkDropListConnectedTo]="[todoList]" class="list"
         (cdkDropListDropped)="drop($event)">
      <div class="list-item" *ngFor="let item of analyzing" cdkDrag>
        <div class="task-header" (click)="toggleTaskDetails(item, analyzing)">
          {{ item.nome }}
          <span *ngIf="item.isExpanded">▲</span>
          <span *ngIf="!item.isExpanded">▼</span>
        </div>
        <div class="task-details" *ngIf="item.isExpanded">
          <p><strong>Observações:</strong> {{ item.observacoes }}</p>
          <p><strong>Data de Criação:</strong> {{ item.data_criacao | date }}</p>
          <p><strong>Data de Entrega:</strong> {{ item.data_entrega | date }}</p>
          <p><strong>Status ID:</strong> {{ item.status_id }}</p>
          <p><strong>Usuário ID:</strong> {{ item.usuario_projeto_usuario_id }}</p>
          <p><strong>Projeto ID:</strong> {{ item.usuario_projeto_projeto_id }}</p>
        </div>
      </div>
    </div>
  </div>

  <div class="container">
    <h2>To Do</h2>
    <div cdkDropList #todoList="cdkDropList" [cdkDropListData]="todo"
         [cdkDropListConnectedTo]="[analyzingList, doingList]" class="list"
         (cdkDropListDropped)="drop($event)">
      <div class="list-item" *ngFor="let item of todo" cdkDrag>
        <div class="task-header" (click)="toggleTaskDetails(item, todo)">
          {{ item.nome }}
          <span *ngIf="item.isExpanded">▲</span>
          <span *ngIf="!item.isExpanded">▼</span>
        </div>
        <div class="task-details" *ngIf="item.isExpanded">
          <p><strong>Observações:</strong> {{ item.observacoes }}</p>
          <p><strong>Data de Criação:</strong> {{ item.data_criacao | date }}</p>
          <p><strong>Data de Entrega:</strong> {{ item.data_entrega | date }}</p>
          <p><strong>Status ID:</strong> {{ item.status_id }}</p>
          <p><strong>Usuário ID:</strong> {{ item.usuario_projeto_usuario_id }}</p>
          <p><strong>Projeto ID:</strong> {{ item.usuario_projeto_projeto_id }}</p>
        </div>
      </div>
    </div>
  </div>

  <div class="container">
    <h2>Doing</h2>
    <div cdkDropList #doingList="cdkDropList" [cdkDropListData]="doing"
         [cdkDropListConnectedTo]="[todoList, doneList]" class="list"
         (cdkDropListDropped)="drop($event)">
      <div class="list-item" *ngFor="let item of doing" cdkDrag>
        <div class="task-header" (click)="toggleTaskDetails(item, doing)">
          {{ item.nome }}
          <span *ngIf="item.isExpanded">▲</span>
          <span *ngIf="!item.isExpanded">▼</span>
        </div>
        <div class="task-details" *ngIf="item.isExpanded">
          <p><strong>Observações:</strong> {{ item.observacoes }}</p>
          <p><strong>Data de Criação:</strong> {{ item.data_criacao | date }}</p>
          <p><strong>Data de Entrega:</strong> {{ item.data_entrega | date }}</p>
          <p><strong>Status ID:</strong> {{ item.status_id }}</p>
          <p><strong>Usuário ID:</strong> {{ item.usuario_projeto_usuario_id }}</p>
          <p><strong>Projeto ID:</strong> {{ item.usuario_projeto_projeto_id }}</p>
        </div>
      </div>
    </div>
  </div>

  <div class="container">
    <h2>Done</h2>
    <div cdkDropList #doneList="cdkDropList" [cdkDropListData]="done"
         class="list" (cdkDropListDropped)="drop($event)">
      <div class="list-item" *ngFor="let item of done | slice:0:maxVisibleItems" cdkDrag>
        <div class="task-header" (click)="toggleTaskDetails(item, done)">
          {{ item.nome }}
          <span *ngIf="item.isExpanded">▲</span>
          <span *ngIf="!item.isExpanded">▼</span>
        </div>
        <div class="task-details" *ngIf="item.isExpanded">
          <p><strong>Observações:</strong> {{ item.observacoes }}</p>
          <p><strong>Data de Criação:</strong> {{ item.data_criacao | date }}</p>
          <p><strong>Data de Entrega:</strong> {{ item.data_entrega | date }}</p>
          <p><strong>Status ID:</strong> {{ item.status_id }}</p>
          <p><strong>Usuário ID:</strong> {{ item.usuario_projeto_usuario_id }}</p>
          <p><strong>Projeto ID:</strong> {{ item.usuario_projeto_projeto_id }}</p>
        </div>
      </div>
      <button *ngIf="done.length > maxVisibleItems" class="expand-button" (click)="toggleDoneList()">
        {{ isDoneExpanded ? 'Show Less ▲' : 'Show More ▼' }}
      </button>
    </div>
  </div>
</div>
